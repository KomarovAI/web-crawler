FEATURE-SPECIFIC CONTEXT (Layer 2 - Module Level)

ðŸ“‹ FOR: Adding new features to crawler.py

CURRENT STRUCTURE:
class Crawler(u, m=50, t=10)
  __init__: u=url, m=max_pages, t=timeout
           v=visited set, q=queue, d=domain
  
  _ok(url) -> bool
    checks: not in v, len(v)<m, same domain, http(s)
  
  async fetch(s, url) -> str|None
    gets HTML, returns None on error
  
  async parse(h, b) -> list
    extracts links with BeautifulSoup
  
  async run() -> dict
    BFS loop: dequeue, fetch, parse, enqueue
    sleep 0.1s between requests
    5 concurrent (TCPConnector limit=5)

KEY VARIABLES:
u = start_url
m = max_pages
t = timeout
v = visited set
q = queue list
d = domain
s = session (aiohttp)
h = html
b = base_url
r = result dict

ADDING FEATURES:
1. Modify __init__ if new params needed
2. Add validation in _ok() for filters
3. Extend fetch() for headers/cookies
4. Extend parse() for data extraction
5. Modify run() for new logic
6. Return: dict with results

CONSTRAINTS:
- Keep async/await throughout
- Max crawler.py = 50 lines
- Use aiohttp only (no requests)
- No new external dependencies
- Preserve BFS pattern
- Error handling required

EXAMPLE ADDITION:
# Add headers
async def fetch(self,s,url)->str|None:
  try:
    h={'User-Agent':'MyBot/1.0'}
    async with s.get(url,timeout=self.t,headers=h,ssl=False)as r:
      return await r.text()if r.status==200 else None
  except:return None
